"use strict";function cov_2dbsw1qhpe(){var path="/Users/taojiang/Documents/work/redux_study/redux_/src/createStore.ts";var hash="b60b1e273ebeba244bc5025267ed66eb3e3b2d89";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/taojiang/Documents/work/redux_study/redux_/src/createStore.ts",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:12,column:30},end:{line:12,column:39}},"2":{start:{line:13,column:4},end:{line:16,column:5}},"3":{start:{line:14,column:8},end:{line:14,column:40}},"4":{start:{line:15,column:8},end:{line:15,column:30}},"5":{start:{line:18,column:4},end:{line:24,column:5}},"6":{start:{line:20,column:29},end:{line:20,column:61}},"7":{start:{line:22,column:8},end:{line:22,column:36}},"8":{start:{line:23,column:8},end:{line:23,column:50}},"9":{start:{line:28,column:16},end:{line:28,column:25}},"10":{start:{line:32,column:20},end:{line:32,column:22}},"11":{start:{line:38,column:8},end:{line:38,column:33}},"12":{start:{line:39,column:8},end:{line:43,column:10}},"13":{start:{line:40,column:22},end:{line:40,column:49}},"14":{start:{line:41,column:12},end:{line:42,column:38}},"15":{start:{line:42,column:16},end:{line:42,column:38}},"16":{start:{line:51,column:23},end:{line:51,column:45}},"17":{start:{line:52,column:8},end:{line:52,column:25}},"18":{start:{line:53,column:18},end:{line:53,column:34}},"19":{start:{line:55,column:8},end:{line:56,column:29}},"20":{start:{line:56,column:12},end:{line:56,column:29}},"21":{start:{line:60,column:8},end:{line:60,column:21}},"22":{start:{line:63,column:4},end:{line:63,column:50}},"23":{start:{line:64,column:4},end:{line:64,column:45}},"24":{start:{line:66,column:0},end:{line:66,column:34}}},fnMap:{"0":{name:"createStore",decl:{start:{line:11,column:9},end:{line:11,column:20}},loc:{start:{line:11,column:66},end:{line:65,column:1}},line:11},"1":{name:"subscribe",decl:{start:{line:37,column:13},end:{line:37,column:22}},loc:{start:{line:37,column:33},end:{line:44,column:5}},line:37},"2":{name:"unsbuscribe",decl:{start:{line:39,column:24},end:{line:39,column:35}},loc:{start:{line:39,column:38},end:{line:43,column:9}},line:39},"3":{name:"dispatch",decl:{start:{line:50,column:13},end:{line:50,column:21}},loc:{start:{line:50,column:30},end:{line:57,column:5}},line:50},"4":{name:"getState",decl:{start:{line:59,column:13},end:{line:59,column:21}},loc:{start:{line:59,column:24},end:{line:61,column:5}},line:59}},branchMap:{"0":{loc:{start:{line:11,column:30},end:{line:11,column:51}},type:"default-arg",locations:[{start:{line:11,column:42},end:{line:11,column:51}}],line:11},"1":{loc:{start:{line:13,column:4},end:{line:16,column:5}},type:"if",locations:[{start:{line:13,column:4},end:{line:16,column:5}},{start:{line:13,column:4},end:{line:16,column:5}}],line:13},"2":{loc:{start:{line:18,column:4},end:{line:24,column:5}},type:"if",locations:[{start:{line:18,column:4},end:{line:24,column:5}},{start:{line:18,column:4},end:{line:24,column:5}}],line:18},"3":{loc:{start:{line:41,column:12},end:{line:42,column:38}},type:"if",locations:[{start:{line:41,column:12},end:{line:42,column:38}},{start:{line:41,column:12},end:{line:42,column:38}}],line:41}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0],"1":[0,0],"2":[0,0],"3":[0,0]},inputSourceMap:{version:3,file:"/Users/taojiang/Documents/work/redux_study/redux_/src/createStore.ts",sources:["/Users/taojiang/Documents/work/redux_study/redux_/src/createStore.ts"],names:[],mappings:";;AA6BA;;;;;;;GAOG;AAEH,SAAS,WAAW,CAAC,OAAgB,EAAE,YAAiB,SAAS,EAAE,WAAsB;IAEvF,IAAI,mBAAmB,GAAG,SAAS,CAAC;IACpC,IAAI,OAAO,SAAS,KAAK,UAAU,EAAE;QACnC,mBAAmB,GAAG,SAAS,CAAC;QAChC,SAAS,GAAG,SAAS,CAAC;KACvB;IAED,YAAY;IACZ,IAAI,mBAAmB,EAAE;QACvB,0BAA0B;QAC1B,IAAI,cAAc,GAAG,mBAAmB,CAAC,WAAW,CAAC,CAAC;QACtD,yCAAyC;QACzC,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;QAC5B,OAAO,cAAc,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC;KAC3C;IAED;;OAEG;IACH,IAAI,KAAK,GAAG,SAAS,CAAC;IAEtB;;OAEG;IACH,IAAI,SAAS,GAAe,EAAE,CAAC;IAE/B;;;OAGG;IACH,SAAS,SAAS,CAAC,QAAkB;QACnC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;QACxB,OAAO,SAAS,WAAW;YACzB,IAAI,GAAG,GAAW,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;YAC9C,IAAI,GAAG,GAAG,CAAC,CAAC;gBAAE,SAAS,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;QACtC,CAAC,CAAA;IACH,CAAC;IAAA,CAAC;IAEF;;;OAGG;IACH,SAAS,QAAQ,CAAC,MAAiB;QACjC,IAAI,QAAQ,GAAG,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;QACtC,KAAK,GAAG,QAAQ,CAAC;QACjB,IAAI,GAAG,GAAG,SAAS,CAAC,MAAM,CAAC;QAC3B,sBAAsB;QACtB,OAAO,EAAE,GAAG,GAAG,CAAC,CAAC;YAAE,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC;IACtC,CAAC;IAAA,CAAC;IAEF,SAAS,QAAQ;QACf,OAAO,KAAK,CAAC;IACf,CAAC;IAED,8DAA8D;IAC9D,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,CAAC,GAAG,CAAC,aAAa,CAAC,EAAE,CAAC,CAAA;IAE7C,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,QAAQ,EAAE,CAAA;AAC1C,CAAC;AAEe,kCAAW",sourcesContent:["\n\n\n/**\n * action\n */\ninterface AnyAction<S = any> {\n  type: string | number | Symbol;\n  [extraProps: string]: any;\n}\n\n/**\n * \u6BCF\u4E2Areducer \u90FD\u4F1A\u8FD4\u56DE\u4E00\u4E2Astate\u7684clone\uFF0C\u6765\u4EE3\u66FF\u65B0\u7684 state\n */\ntype Reducer = (state: any, action: AnyAction) => any;\n\n/** \u53D6\u6D88\u8BA2\u9605 */\ntype unsbuscribe = () => void;\n\n\n/**\n * Store \u5BF9\u8C61\n */\ninterface Store {\n  subscribe: (listener: Function) => unsbuscribe;\n  dispatch: (action: AnyAction) => void;\n  getState: () => any;\n}\n\n/**\n * \u9762\u5411\u51FD\u6570\u662F\u601D\u7EF4\n *  value \u5373\u662F state\n *  dispatch -> map\n *  \n * \u521B\u5EFA\u4E00\u4E2Astore\u5BB9\u5668,\u57FA\u4E8E\u53D1\u5E03\u8BA2\u6A21\u5F0F\u6765\u5904\u7406\uFF0Cdispatch\u6D3E\u53D1\u51FA\u7684action\u5904\u7406\u5BF9\u5E94\u7684reducer\n * \u6CE8\u610F:Action \u552F\u4E00\n */\n\nfunction createStore(reducer: Reducer, initState: any = undefined, middlewares?: Function): Store {\n\n  let overrideCreateStore = undefined;\n  if (typeof initState === 'function') {\n    overrideCreateStore = initState;\n    initState = undefined;\n  }\n\n  //\u5982\u679C\u6709\u4E2D\u95F4\u4EF6\u7684\u60C5\u51B5\u4E0B\n  if (overrideCreateStore) {\n    /**\u62FF\u5230\u91CD\u5199\u7684 createStore \u65B9\u6CD5 */\n    let newCreateStore = overrideCreateStore(createStore);\n    //\u4F7F\u7528\u65B0\u7684\u65B9\u6CD5\u521B\u5EFAstore\uFF0C\u5176\u4E2D\u4F1A\u7528\u4E2D\u95F4\u4EF6\u6D0B\u8471\u6A21\u578B\u91CD\u5199 dispatch \u65B9\u6CD5\n    console.log(newCreateStore);\n    return newCreateStore(reducer, initState);\n  }\n\n  /**\n   *  \u72B6\u6001\u7BA1\u7406\n   */\n  let state = initState;\n\n  /**\n   * \u8BA2\u9605\u8005\u7684\u5217\u8868 \n   */\n  let listeners: Function[] = [];\n\n  /**\n   * \u89C2\u5BDF\u6D88\u606F\u8BA2\u9605\n   * @param listener \n   */\n  function subscribe(listener: Function) {\n    listeners.push(listener)\n    return function unsbuscribe() {\n      let del: number = listeners.indexOf(listener);\n      if (del > -1) listeners.splice(del);\n    }\n  };\n\n  /**\n   * \u6D3E\u53D1\u4E00\u4E2A action \u5BF9\u8C61\n   * @param action \n   */\n  function dispatch(action: AnyAction) {\n    let newState = reducer(state, action);\n    state = newState;\n    let len = listeners.length;\n    //reducer \u5904\u7406\u5B8C\u4E86\u4E4B\u540E\uFF0C\u56DE\u8C03\u8BA2\u9605\u8005\n    while (--len > -1) listeners[len]();\n  };\n\n  function getState(): any {\n    return state;\n  }\n\n  /**\u5728createStore \u88AB\u8C03\u7528\u7684\u65F6\u5019\u5148\u521D\u59CB\u5316\u6240\u6709\u7684reducer\uFF0C\u8FD9\u4E2A\u7684reducer\u662F\u7A7F\u900F\u7684\u6BCF\u4E2A\u90FD\u4F1A\u6267\u884C\u5230\u4F4D */\n  dispatch({ type: Symbol.for('initReuders') })\n\n  return { dispatch, subscribe, getState }\n}\n\nexport { Store, createStore, Reducer, AnyAction, unsbuscribe }"]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"b60b1e273ebeba244bc5025267ed66eb3e3b2d89"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];cov_2dbsw1qhpe=function(){return actualCoverage;};return actualCoverage;}cov_2dbsw1qhpe();cov_2dbsw1qhpe().s[0]++;Object.defineProperty(exports,"__esModule",{value:true});/**
 * 面向函数是思维
 *  value 即是 state
 *  dispatch -> map
 *
 * 创建一个store容器,基于发布订模式来处理，dispatch派发出的action处理对应的reducer
 * 注意:Action 唯一
 */function createStore(reducer,initState=(cov_2dbsw1qhpe().b[0][0]++,undefined),middlewares){cov_2dbsw1qhpe().f[0]++;let overrideCreateStore=(cov_2dbsw1qhpe().s[1]++,undefined);cov_2dbsw1qhpe().s[2]++;if(typeof initState==='function'){cov_2dbsw1qhpe().b[1][0]++;cov_2dbsw1qhpe().s[3]++;overrideCreateStore=initState;cov_2dbsw1qhpe().s[4]++;initState=undefined;}else{cov_2dbsw1qhpe().b[1][1]++;}//如果有中间件的情况下
cov_2dbsw1qhpe().s[5]++;if(overrideCreateStore){cov_2dbsw1qhpe().b[2][0]++;/**拿到重写的 createStore 方法 */let newCreateStore=(cov_2dbsw1qhpe().s[6]++,overrideCreateStore(createStore));//使用新的方法创建store，其中会用中间件洋葱模型重写 dispatch 方法
cov_2dbsw1qhpe().s[7]++;console.log(newCreateStore);cov_2dbsw1qhpe().s[8]++;return newCreateStore(reducer,initState);}else{cov_2dbsw1qhpe().b[2][1]++;}/**
     *  状态管理
     */let state=(cov_2dbsw1qhpe().s[9]++,initState);/**
     * 订阅者的列表
     */let listeners=(cov_2dbsw1qhpe().s[10]++,[]);/**
     * 观察消息订阅
     * @param listener
     */function subscribe(listener){cov_2dbsw1qhpe().f[1]++;cov_2dbsw1qhpe().s[11]++;listeners.push(listener);cov_2dbsw1qhpe().s[12]++;return function unsbuscribe(){cov_2dbsw1qhpe().f[2]++;let del=(cov_2dbsw1qhpe().s[13]++,listeners.indexOf(listener));cov_2dbsw1qhpe().s[14]++;if(del>-1){cov_2dbsw1qhpe().b[3][0]++;cov_2dbsw1qhpe().s[15]++;listeners.splice(del);}else{cov_2dbsw1qhpe().b[3][1]++;}};};/**
     * 派发一个 action 对象
     * @param action
     */function dispatch(action){cov_2dbsw1qhpe().f[3]++;let newState=(cov_2dbsw1qhpe().s[16]++,reducer(state,action));cov_2dbsw1qhpe().s[17]++;state=newState;let len=(cov_2dbsw1qhpe().s[18]++,listeners.length);//reducer 处理完了之后，回调订阅者
cov_2dbsw1qhpe().s[19]++;while(--len>-1){cov_2dbsw1qhpe().s[20]++;listeners[len]();}};function getState(){cov_2dbsw1qhpe().f[4]++;cov_2dbsw1qhpe().s[21]++;return state;}/**在createStore 被调用的时候先初始化所有的reducer，这个的reducer是穿透的每个都会执行到位 */cov_2dbsw1qhpe().s[22]++;dispatch({type:Symbol.for('initReuders')});cov_2dbsw1qhpe().s[23]++;return{dispatch,subscribe,getState};}cov_2dbsw1qhpe().s[24]++;exports.createStore=createStore;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3Rhb2ppYW5nL0RvY3VtZW50cy93b3JrL3JlZHV4X3N0dWR5L3JlZHV4Xy9zcmMvY3JlYXRlU3RvcmUudHMiLCJzb3VyY2VzIjpbIi9Vc2Vycy90YW9qaWFuZy9Eb2N1bWVudHMvd29yay9yZWR1eF9zdHVkeS9yZWR1eF8vc3JjL2NyZWF0ZVN0b3JlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBNkJBOzs7Ozs7O0dBT0c7QUFFSCxTQUFTLFdBQVcsQ0FBQyxPQUFnQixFQUFFLFlBQWlCLFNBQVMsRUFBRSxXQUFzQjtJQUV2RixJQUFJLG1CQUFtQixHQUFHLFNBQVMsQ0FBQztJQUNwQyxJQUFJLE9BQU8sU0FBUyxLQUFLLFVBQVUsRUFBRTtRQUNuQyxtQkFBbUIsR0FBRyxTQUFTLENBQUM7UUFDaEMsU0FBUyxHQUFHLFNBQVMsQ0FBQztLQUN2QjtJQUVELFlBQVk7SUFDWixJQUFJLG1CQUFtQixFQUFFO1FBQ3ZCLDBCQUEwQjtRQUMxQixJQUFJLGNBQWMsR0FBRyxtQkFBbUIsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUN0RCx5Q0FBeUM7UUFDekMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUM1QixPQUFPLGNBQWMsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLENBQUM7S0FDM0M7SUFFRDs7T0FFRztJQUNILElBQUksS0FBSyxHQUFHLFNBQVMsQ0FBQztJQUV0Qjs7T0FFRztJQUNILElBQUksU0FBUyxHQUFlLEVBQUUsQ0FBQztJQUUvQjs7O09BR0c7SUFDSCxTQUFTLFNBQVMsQ0FBQyxRQUFrQjtRQUNuQyxTQUFTLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFBO1FBQ3hCLE9BQU8sU0FBUyxXQUFXO1lBQ3pCLElBQUksR0FBRyxHQUFXLFNBQVMsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDOUMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDO2dCQUFFLFNBQVMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDdEMsQ0FBQyxDQUFBO0lBQ0gsQ0FBQztJQUFBLENBQUM7SUFFRjs7O09BR0c7SUFDSCxTQUFTLFFBQVEsQ0FBQyxNQUFpQjtRQUNqQyxJQUFJLFFBQVEsR0FBRyxPQUFPLENBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQ3RDLEtBQUssR0FBRyxRQUFRLENBQUM7UUFDakIsSUFBSSxHQUFHLEdBQUcsU0FBUyxDQUFDLE1BQU0sQ0FBQztRQUMzQixzQkFBc0I7UUFDdEIsT0FBTyxFQUFFLEdBQUcsR0FBRyxDQUFDLENBQUM7WUFBRSxTQUFTLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQztJQUN0QyxDQUFDO0lBQUEsQ0FBQztJQUVGLFNBQVMsUUFBUTtRQUNmLE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQztJQUVELDhEQUE4RDtJQUM5RCxRQUFRLENBQUMsRUFBRSxJQUFJLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsRUFBRSxDQUFDLENBQUE7SUFFN0MsT0FBTyxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLENBQUE7QUFDMUMsQ0FBQztBQUVlLGtDQUFXIiwic291cmNlc0NvbnRlbnQiOlsiXG5cblxuLyoqXG4gKiBhY3Rpb25cbiAqL1xuaW50ZXJmYWNlIEFueUFjdGlvbjxTID0gYW55PiB7XG4gIHR5cGU6IHN0cmluZyB8IG51bWJlciB8IFN5bWJvbDtcbiAgW2V4dHJhUHJvcHM6IHN0cmluZ106IGFueTtcbn1cblxuLyoqXG4gKiDmr4/kuKpyZWR1Y2VyIOmDveS8mui/lOWbnuS4gOS4qnN0YXRl55qEY2xvbmXvvIzmnaXku6Pmm7/mlrDnmoQgc3RhdGVcbiAqL1xudHlwZSBSZWR1Y2VyID0gKHN0YXRlOiBhbnksIGFjdGlvbjogQW55QWN0aW9uKSA9PiBhbnk7XG5cbi8qKiDlj5bmtojorqLpmIUgKi9cbnR5cGUgdW5zYnVzY3JpYmUgPSAoKSA9PiB2b2lkO1xuXG5cbi8qKlxuICogU3RvcmUg5a+56LGhXG4gKi9cbmludGVyZmFjZSBTdG9yZSB7XG4gIHN1YnNjcmliZTogKGxpc3RlbmVyOiBGdW5jdGlvbikgPT4gdW5zYnVzY3JpYmU7XG4gIGRpc3BhdGNoOiAoYWN0aW9uOiBBbnlBY3Rpb24pID0+IHZvaWQ7XG4gIGdldFN0YXRlOiAoKSA9PiBhbnk7XG59XG5cbi8qKlxuICog6Z2i5ZCR5Ye95pWw5piv5oCd57u0XG4gKiAgdmFsdWUg5Y2z5pivIHN0YXRlXG4gKiAgZGlzcGF0Y2ggLT4gbWFwXG4gKiAgXG4gKiDliJvlu7rkuIDkuKpzdG9yZeWuueWZqCzln7rkuo7lj5HluIPorqLmqKHlvI/mnaXlpITnkIbvvIxkaXNwYXRjaOa0vuWPkeWHuueahGFjdGlvbuWkhOeQhuWvueW6lOeahHJlZHVjZXJcbiAqIOazqOaEjzpBY3Rpb24g5ZSv5LiAXG4gKi9cblxuZnVuY3Rpb24gY3JlYXRlU3RvcmUocmVkdWNlcjogUmVkdWNlciwgaW5pdFN0YXRlOiBhbnkgPSB1bmRlZmluZWQsIG1pZGRsZXdhcmVzPzogRnVuY3Rpb24pOiBTdG9yZSB7XG5cbiAgbGV0IG92ZXJyaWRlQ3JlYXRlU3RvcmUgPSB1bmRlZmluZWQ7XG4gIGlmICh0eXBlb2YgaW5pdFN0YXRlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgb3ZlcnJpZGVDcmVhdGVTdG9yZSA9IGluaXRTdGF0ZTtcbiAgICBpbml0U3RhdGUgPSB1bmRlZmluZWQ7XG4gIH1cblxuICAvL+WmguaenOacieS4remXtOS7tueahOaDheWGteS4i1xuICBpZiAob3ZlcnJpZGVDcmVhdGVTdG9yZSkge1xuICAgIC8qKuaLv+WIsOmHjeWGmeeahCBjcmVhdGVTdG9yZSDmlrnms5UgKi9cbiAgICBsZXQgbmV3Q3JlYXRlU3RvcmUgPSBvdmVycmlkZUNyZWF0ZVN0b3JlKGNyZWF0ZVN0b3JlKTtcbiAgICAvL+S9v+eUqOaWsOeahOaWueazleWIm+W7unN0b3Jl77yM5YW25Lit5Lya55So5Lit6Ze05Lu25rSL6JGx5qih5Z6L6YeN5YaZIGRpc3BhdGNoIOaWueazlVxuICAgIGNvbnNvbGUubG9nKG5ld0NyZWF0ZVN0b3JlKTtcbiAgICByZXR1cm4gbmV3Q3JlYXRlU3RvcmUocmVkdWNlciwgaW5pdFN0YXRlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiAg54q25oCB566h55CGXG4gICAqL1xuICBsZXQgc3RhdGUgPSBpbml0U3RhdGU7XG5cbiAgLyoqXG4gICAqIOiuoumYheiAheeahOWIl+ihqCBcbiAgICovXG4gIGxldCBsaXN0ZW5lcnM6IEZ1bmN0aW9uW10gPSBbXTtcblxuICAvKipcbiAgICog6KeC5a+f5raI5oGv6K6i6ZiFXG4gICAqIEBwYXJhbSBsaXN0ZW5lciBcbiAgICovXG4gIGZ1bmN0aW9uIHN1YnNjcmliZShsaXN0ZW5lcjogRnVuY3Rpb24pIHtcbiAgICBsaXN0ZW5lcnMucHVzaChsaXN0ZW5lcilcbiAgICByZXR1cm4gZnVuY3Rpb24gdW5zYnVzY3JpYmUoKSB7XG4gICAgICBsZXQgZGVsOiBudW1iZXIgPSBsaXN0ZW5lcnMuaW5kZXhPZihsaXN0ZW5lcik7XG4gICAgICBpZiAoZGVsID4gLTEpIGxpc3RlbmVycy5zcGxpY2UoZGVsKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIOa0vuWPkeS4gOS4qiBhY3Rpb24g5a+56LGhXG4gICAqIEBwYXJhbSBhY3Rpb24gXG4gICAqL1xuICBmdW5jdGlvbiBkaXNwYXRjaChhY3Rpb246IEFueUFjdGlvbikge1xuICAgIGxldCBuZXdTdGF0ZSA9IHJlZHVjZXIoc3RhdGUsIGFjdGlvbik7XG4gICAgc3RhdGUgPSBuZXdTdGF0ZTtcbiAgICBsZXQgbGVuID0gbGlzdGVuZXJzLmxlbmd0aDtcbiAgICAvL3JlZHVjZXIg5aSE55CG5a6M5LqG5LmL5ZCO77yM5Zue6LCD6K6i6ZiF6ICFXG4gICAgd2hpbGUgKC0tbGVuID4gLTEpIGxpc3RlbmVyc1tsZW5dKCk7XG4gIH07XG5cbiAgZnVuY3Rpb24gZ2V0U3RhdGUoKTogYW55IHtcbiAgICByZXR1cm4gc3RhdGU7XG4gIH1cblxuICAvKirlnKhjcmVhdGVTdG9yZSDooqvosIPnlKjnmoTml7blgJnlhYjliJ3lp4vljJbmiYDmnInnmoRyZWR1Y2Vy77yM6L+Z5Liq55qEcmVkdWNlcuaYr+epv+mAj+eahOavj+S4qumDveS8muaJp+ihjOWIsOS9jSAqL1xuICBkaXNwYXRjaCh7IHR5cGU6IFN5bWJvbC5mb3IoJ2luaXRSZXVkZXJzJykgfSlcblxuICByZXR1cm4geyBkaXNwYXRjaCwgc3Vic2NyaWJlLCBnZXRTdGF0ZSB9XG59XG5cbmV4cG9ydCB7IFN0b3JlLCBjcmVhdGVTdG9yZSwgUmVkdWNlciwgQW55QWN0aW9uLCB1bnNidXNjcmliZSB9Il19
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy90YW9qaWFuZy9Eb2N1bWVudHMvd29yay9yZWR1eF9zdHVkeS9yZWR1eF8vc3JjL2NyZWF0ZVN0b3JlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI2aVFBNkJBOzs7Ozs7O0dBU0EsUUFBUyxDQUFBLFdBQVQsQ0FBcUIsT0FBckIsQ0FBdUMsU0FBQSw2QkFBaUIsU0FBakIsQ0FBdkMsQ0FBbUUsV0FBbkUsQ0FBeUYseUJBRXZGLEdBQUksQ0FBQSxtQkFBbUIsMEJBQUcsU0FBSCxDQUF2QixDQUZ1Rix3QkFHdkYsR0FBSSxNQUFPLENBQUEsU0FBUCxHQUFxQixVQUF6QixDQUFxQyxvREFDbkMsbUJBQW1CLENBQUcsU0FBdEIsQ0FEbUMsd0JBRW5DLFNBQVMsQ0FBRyxTQUFaLENBQ0QsQ0FIRCxpQ0FLQTtBQVJ1Rix3QkFTdkYsR0FBSSxtQkFBSixDQUF5Qiw0QkFDdkIsMEJBQ0EsR0FBSSxDQUFBLGNBQWMsMEJBQUcsbUJBQW1CLENBQUMsV0FBRCxDQUF0QixDQUFsQixDQUNBO0FBSHVCLHdCQUl2QixPQUFPLENBQUMsR0FBUixDQUFZLGNBQVosRUFKdUIsd0JBS3ZCLE1BQU8sQ0FBQSxjQUFjLENBQUMsT0FBRCxDQUFVLFNBQVYsQ0FBckIsQ0FDRCxDQU5ELGlDQVFBOztPQUdBLEdBQUksQ0FBQSxLQUFLLDBCQUFHLFNBQUgsQ0FBVCxDQUVBOztPQUdBLEdBQUksQ0FBQSxTQUFTLDJCQUFlLEVBQWYsQ0FBYixDQUVBOzs7T0FJQSxRQUFTLENBQUEsU0FBVCxDQUFtQixRQUFuQixDQUFxQyxrREFDbkMsU0FBUyxDQUFDLElBQVYsQ0FBZSxRQUFmLEVBRG1DLHlCQUVuQyxNQUFPLFNBQVMsQ0FBQSxXQUFULEVBQW9CLHlCQUN6QixHQUFJLENBQUEsR0FBRywyQkFBVyxTQUFTLENBQUMsT0FBVixDQUFrQixRQUFsQixDQUFYLENBQVAsQ0FEeUIseUJBRXpCLEdBQUksR0FBRyxDQUFHLENBQUMsQ0FBWCxDQUFjLHFEQUFBLFNBQVMsQ0FBQyxNQUFWLENBQWlCLEdBQWpCLEVBQXNCLENBQXBDLGlDQUNELENBSEQsQ0FJRCxDQUFBLENBRUQ7OztPQUlBLFFBQVMsQ0FBQSxRQUFULENBQWtCLE1BQWxCLENBQW1DLHlCQUNqQyxHQUFJLENBQUEsUUFBUSwyQkFBRyxPQUFPLENBQUMsS0FBRCxDQUFRLE1BQVIsQ0FBVixDQUFaLENBRGlDLHlCQUVqQyxLQUFLLENBQUcsUUFBUixDQUNBLEdBQUksQ0FBQSxHQUFHLDJCQUFHLFNBQVMsQ0FBQyxNQUFiLENBQVAsQ0FDQTtBQUppQyx5QkFLakMsTUFBTyxFQUFFLEdBQUYsQ0FBUSxDQUFDLENBQWhCLENBQW1CLDBCQUFBLFNBQVMsQ0FBQyxHQUFELENBQVQsR0FBaUIsQ0FDckMsQ0FBQSxDQUVELFFBQVMsQ0FBQSxRQUFULEVBQWlCLGtEQUNmLE1BQU8sQ0FBQSxLQUFQLENBQ0QsQ0FFRCw4REF2RHVGLHlCQXdEdkYsUUFBUSxDQUFDLENBQUUsSUFBSSxDQUFFLE1BQU0sQ0FBQyxHQUFQLENBQVcsYUFBWCxDQUFSLENBQUQsQ0FBUixDQXhEdUYseUJBMER2RixNQUFPLENBQUUsUUFBRixDQUFZLFNBQVosQ0FBdUIsUUFBdkIsQ0FBUCxDQUNELEMseUJBRWUsT0FBQSxDQUFBLFdBQUEsQ0FBQSxXQUFBLEMiLCJzb3VyY2VzQ29udGVudCI6WyJcblxuXG4vKipcbiAqIGFjdGlvblxuICovXG5pbnRlcmZhY2UgQW55QWN0aW9uPFMgPSBhbnk+IHtcbiAgdHlwZTogc3RyaW5nIHwgbnVtYmVyIHwgU3ltYm9sO1xuICBbZXh0cmFQcm9wczogc3RyaW5nXTogYW55O1xufVxuXG4vKipcbiAqIOavj+S4qnJlZHVjZXIg6YO95Lya6L+U5Zue5LiA5Liqc3RhdGXnmoRjbG9uZe+8jOadpeS7o+abv+aWsOeahCBzdGF0ZVxuICovXG50eXBlIFJlZHVjZXIgPSAoc3RhdGU6IGFueSwgYWN0aW9uOiBBbnlBY3Rpb24pID0+IGFueTtcblxuLyoqIOWPlua2iOiuoumYhSAqL1xudHlwZSB1bnNidXNjcmliZSA9ICgpID0+IHZvaWQ7XG5cblxuLyoqXG4gKiBTdG9yZSDlr7nosaFcbiAqL1xuaW50ZXJmYWNlIFN0b3JlIHtcbiAgc3Vic2NyaWJlOiAobGlzdGVuZXI6IEZ1bmN0aW9uKSA9PiB1bnNidXNjcmliZTtcbiAgZGlzcGF0Y2g6IChhY3Rpb246IEFueUFjdGlvbikgPT4gdm9pZDtcbiAgZ2V0U3RhdGU6ICgpID0+IGFueTtcbn1cblxuLyoqXG4gKiDpnaLlkJHlh73mlbDmmK/mgJ3nu7RcbiAqICB2YWx1ZSDljbPmmK8gc3RhdGVcbiAqICBkaXNwYXRjaCAtPiBtYXBcbiAqICBcbiAqIOWIm+W7uuS4gOS4qnN0b3Jl5a655ZmoLOWfuuS6juWPkeW4g+iuouaooeW8j+adpeWkhOeQhu+8jGRpc3BhdGNo5rS+5Y+R5Ye655qEYWN0aW9u5aSE55CG5a+55bqU55qEcmVkdWNlclxuICog5rOo5oSPOkFjdGlvbiDllK/kuIBcbiAqL1xuXG5mdW5jdGlvbiBjcmVhdGVTdG9yZShyZWR1Y2VyOiBSZWR1Y2VyLCBpbml0U3RhdGU6IGFueSA9IHVuZGVmaW5lZCwgbWlkZGxld2FyZXM/OiBGdW5jdGlvbik6IFN0b3JlIHtcblxuICBsZXQgb3ZlcnJpZGVDcmVhdGVTdG9yZSA9IHVuZGVmaW5lZDtcbiAgaWYgKHR5cGVvZiBpbml0U3RhdGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICBvdmVycmlkZUNyZWF0ZVN0b3JlID0gaW5pdFN0YXRlO1xuICAgIGluaXRTdGF0ZSA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIC8v5aaC5p6c5pyJ5Lit6Ze05Lu255qE5oOF5Ya15LiLXG4gIGlmIChvdmVycmlkZUNyZWF0ZVN0b3JlKSB7XG4gICAgLyoq5ou/5Yiw6YeN5YaZ55qEIGNyZWF0ZVN0b3JlIOaWueazlSAqL1xuICAgIGxldCBuZXdDcmVhdGVTdG9yZSA9IG92ZXJyaWRlQ3JlYXRlU3RvcmUoY3JlYXRlU3RvcmUpO1xuICAgIC8v5L2/55So5paw55qE5pa55rOV5Yib5bu6c3RvcmXvvIzlhbbkuK3kvJrnlKjkuK3pl7Tku7bmtIvokbHmqKHlnovph43lhpkgZGlzcGF0Y2gg5pa55rOVXG4gICAgY29uc29sZS5sb2cobmV3Q3JlYXRlU3RvcmUpO1xuICAgIHJldHVybiBuZXdDcmVhdGVTdG9yZShyZWR1Y2VyLCBpbml0U3RhdGUpO1xuICB9XG5cbiAgLyoqXG4gICAqICDnirbmgIHnrqHnkIZcbiAgICovXG4gIGxldCBzdGF0ZSA9IGluaXRTdGF0ZTtcblxuICAvKipcbiAgICog6K6i6ZiF6ICF55qE5YiX6KGoIFxuICAgKi9cbiAgbGV0IGxpc3RlbmVyczogRnVuY3Rpb25bXSA9IFtdO1xuXG4gIC8qKlxuICAgKiDop4Llr5/mtojmga/orqLpmIVcbiAgICogQHBhcmFtIGxpc3RlbmVyIFxuICAgKi9cbiAgZnVuY3Rpb24gc3Vic2NyaWJlKGxpc3RlbmVyOiBGdW5jdGlvbikge1xuICAgIGxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKVxuICAgIHJldHVybiBmdW5jdGlvbiB1bnNidXNjcmliZSgpIHtcbiAgICAgIGxldCBkZWw6IG51bWJlciA9IGxpc3RlbmVycy5pbmRleE9mKGxpc3RlbmVyKTtcbiAgICAgIGlmIChkZWwgPiAtMSkgbGlzdGVuZXJzLnNwbGljZShkZWwpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICog5rS+5Y+R5LiA5LiqIGFjdGlvbiDlr7nosaFcbiAgICogQHBhcmFtIGFjdGlvbiBcbiAgICovXG4gIGZ1bmN0aW9uIGRpc3BhdGNoKGFjdGlvbjogQW55QWN0aW9uKSB7XG4gICAgbGV0IG5ld1N0YXRlID0gcmVkdWNlcihzdGF0ZSwgYWN0aW9uKTtcbiAgICBzdGF0ZSA9IG5ld1N0YXRlO1xuICAgIGxldCBsZW4gPSBsaXN0ZW5lcnMubGVuZ3RoO1xuICAgIC8vcmVkdWNlciDlpITnkIblrozkuobkuYvlkI7vvIzlm57osIPorqLpmIXogIVcbiAgICB3aGlsZSAoLS1sZW4gPiAtMSkgbGlzdGVuZXJzW2xlbl0oKTtcbiAgfTtcblxuICBmdW5jdGlvbiBnZXRTdGF0ZSgpOiBhbnkge1xuICAgIHJldHVybiBzdGF0ZTtcbiAgfVxuXG4gIC8qKuWcqGNyZWF0ZVN0b3JlIOiiq+iwg+eUqOeahOaXtuWAmeWFiOWIneWni+WMluaJgOacieeahHJlZHVjZXLvvIzov5nkuKrnmoRyZWR1Y2Vy5piv56m/6YCP55qE5q+P5Liq6YO95Lya5omn6KGM5Yiw5L2NICovXG4gIGRpc3BhdGNoKHsgdHlwZTogU3ltYm9sLmZvcignaW5pdFJldWRlcnMnKSB9KVxuXG4gIHJldHVybiB7IGRpc3BhdGNoLCBzdWJzY3JpYmUsIGdldFN0YXRlIH1cbn1cblxuZXhwb3J0IHsgU3RvcmUsIGNyZWF0ZVN0b3JlLCBSZWR1Y2VyLCBBbnlBY3Rpb24sIHVuc2J1c2NyaWJlIH0iXX0=